import{_ as H}from"./BigN8WfK.js";import{h as F,i as j,j as x,o as u,p as B,w as d,b as i,a,c as y,E as D,t as b,n as t,S as O,T as U,V as Q,v as N,z as W,F as Y,L as G,O as J,P as K,Q as X,k as Z,l as tt,m as et,W as ot,d as I,_ as st}from"./ZNDynpV9.js";import{_ as at}from"./BLM6mTaH.js";import{_ as nt}from"./COqeareK.js";import{_ as w}from"./DMdrb1v-.js";import{m as it}from"./hciIiN07.js";import{_ as rt}from"./D0rljJzH.js";import{u as k}from"./BghgCxMP.js";import{p as lt}from"./yLjUMj7D.js";import"./Cgsxdifr.js";import"./BeJo9d9o.js";import"./DbZV3ex3.js";import"./BwzDN0iF.js";import"./B43s0sh1.js";import"./Cuj1jmE5.js";import"./Cpj98o6Y.js";import"./Dq3mKaok.js";import"./ClG46k81.js";const ct={class:"grid grid-cols-[auto,_1fr,_auto] gap-4 items-center my-8"},dt={class:"flex gap-x-4 items-center"},mt={class:"relative bg-foreground size-[30px] rounded-full"},ut={class:"place-center text-lg font-bold text-background"},_t={class:"space-y-px"},pt={key:0,class:"text-[#FFEE99]"},ft={class:"font-semibold"},vt={key:0,class:"py-20 absolute -top-2 inset-0 grid place-items-center"},gt=F({__name:"event-top-spenders",props:{spenders:{default:()=>it},loading:{type:Boolean,default:!1}},setup(S){const n=S,_=s=>{s.preventDefault()},{authEmail:p}=j(),$=x(()=>{if(!(n!=null&&n.spenders))return[];const s=n.spenders.map((o,e)=>({...o,position:e+1,active:o.email===p.value,name:(o==null?void 0:o.name)??(o==null?void 0:o.email)??""})),l=s.find(o=>o.email===p.value),r=s.slice(0,6),c=!!l&&r.some(o=>o.email===p.value);return l&&!c&&r.splice(r.length-1,1,l),r});return(s,l)=>{const r=J,c=K,o=X;return u(),B(o,null,{default:d(()=>[i(c,{class:"relative"},{default:d(()=>[l[0]||(l[0]=a("div",{class:"font-display text-3xl font-bold pb-4 border-b border-input"}," Top Spenders ",-1)),(u(!0),y(Y,null,D(t($),(e,C)=>(u(),B(r,{key:e.user_id+e.email,value:e.user_id+e.email,onSelect:_},{default:d(()=>{var h;return[a("div",ct,[a("div",dt,[a("div",mt,[a("div",ut,b(e.position),1)]),i(rt,{initials:("getInitials"in s?s.getInitials:t(O))(e.name),class:"font-bold text-lg",style:U({backgroundColor:("getHexColor"in s?s.getHexColor:t(Q))(((h=e==null?void 0:e.name)==null?void 0:h.charAt(0))??"A"),color:"black"})},null,8,["initials","style"])]),a("div",_t,[a("div",null,b(e.name),1),e.active?(u(),y("div",pt,"You")):N("",!0)]),a("div",ft," â‚¦"+b(("formatMoney"in s?s.formatMoney:t(W))((e==null?void 0:e.total)??0)),1)])]}),_:2},1032,["value"]))),128)),s.loading?(u(),y("div",vt,[i(t(G),{class:"size-4 animate-spin"})])):N("",!0)]),_:1})]),_:1})}}}),ht={class:"container pb-20"},xt={class:"place-center text-center grid place-items-center gap-4"},yt={class:"text-destructive text-clip"},bt={class:"grid grid-cols-1 lg:grid-cols-[1fr_400px] gap-x-20 gap-y-6 mt-20"},$t={class:"absolute w-[450px] h-0 overflow-hidden"},kt={class:"flex justify-center my-4"},jt=F({__name:"request-receipt",setup(S){var L;const n=Z(),{data:_,status:p,error:$}=k(`events/${n.params.event_id}`),s=((L=n==null?void 0:n.query)==null?void 0:L.reference)??"",{data:l,status:r,error:c,refresh:o}=k(`transactions/${s}/verify`,{immediate:!!s}),{data:e,status:C,refresh:h}=k(`/events/top/spenders/${n.params.event_id}?includeLiveEvent=1`);tt(()=>r.value,async f=>{await lt(500),f==="success"&&h()},{immediate:!0});const q=x(()=>p.value==="pending"||r.value==="pending"),R=x(()=>$.value??c.value),M=n.params.request_id,E=x(()=>{var f;return(f=_.value)==null?void 0:f.data.requests.find(m=>`${m.id}`==`${M}`)});return et({title:"Request Receipt"}),(f,m)=>{const V=H,z=st,A=at,P=nt;return u(),y("div",ht,[i(V,{class:"fixed top-20",to:`/${t(n).params.host}`},null,8,["to"]),i(P,{loading:t(q),error:t(R)},ot({default:d(()=>{var v,g,T;return[a("div",bt,[a("div",null,[i(w,{request:t(E),event:(v=t(_))==null?void 0:v.data},null,8,["request","event"]),a("div",$t,[i(w,{request:t(E),event:(g=t(_))==null?void 0:g.data,print:"",id:"RECEIPT_PRINT"},null,8,["request","event"])]),a("div",kt,[i(A,{to:`/${t(n).params.host}`,class:"underline hover:no-underline"},{default:d(()=>m[1]||(m[1]=[I(" CONTINUE ")])),_:1},8,["to"])])]),a("div",null,[i(gt,{loading:t(C)==="pending",spenders:((T=t(e))==null?void 0:T.data)??[]},null,8,["loading","spenders"])])])]}),_:2},[t(c)?{name:"error",fn:d(()=>{var v,g;return[a("div",xt,[a("div",yt,b(((g=(v=t(c))==null?void 0:v.data)==null?void 0:g.message)??"Payment verification failed"),1),i(z,{variant:"outline",onClick:t(o),loading:t(q)},{default:d(()=>m[0]||(m[0]=[I(" Confirm again ")])),_:1},8,["onClick","loading"])])]}),key:"0"}:void 0]),1032,["loading","error"])])}}});export{jt as default};
