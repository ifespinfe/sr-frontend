import{c as W,g as te}from"./Cpj98o6Y.js";import{r as Y}from"./ZNDynpV9.js";var J={exports:{}},ie=J.exports,Z;function ae(){return Z||(Z=1,function(N,V){(function(a,w){w()})(ie,function(){function a(s,f){return typeof f>"u"?f={autoBom:!1}:typeof f!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),f={autoBom:!f}),f.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}function w(s,f,A){var d=new XMLHttpRequest;d.open("GET",s),d.responseType="blob",d.onload=function(){S(d.response,f,A)},d.onerror=function(){console.error("could not download file")},d.send()}function D(s){var f=new XMLHttpRequest;f.open("HEAD",s,!1);try{f.send()}catch{}return 200<=f.status&&299>=f.status}function F(s){try{s.dispatchEvent(new MouseEvent("click"))}catch{var f=document.createEvent("MouseEvents");f.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),s.dispatchEvent(f)}}var v=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof W=="object"&&W.global===W?W:void 0,y=v.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),S=v.saveAs||(typeof window!="object"||window!==v?function(){}:"download"in HTMLAnchorElement.prototype&&!y?function(s,f,A){var d=v.URL||v.webkitURL,P=document.createElement("a");f=f||s.name||"download",P.download=f,P.rel="noopener",typeof s=="string"?(P.href=s,P.origin===location.origin?F(P):D(P.href)?w(s,f,A):F(P,P.target="_blank")):(P.href=d.createObjectURL(s),setTimeout(function(){d.revokeObjectURL(P.href)},4e4),setTimeout(function(){F(P)},0))}:"msSaveOrOpenBlob"in navigator?function(s,f,A){if(f=f||s.name||"download",typeof s!="string")navigator.msSaveOrOpenBlob(a(s,A),f);else if(D(s))w(s,f,A);else{var d=document.createElement("a");d.href=s,d.target="_blank",setTimeout(function(){F(d)})}}:function(s,f,A,d){if(d=d||open("","_blank"),d&&(d.document.title=d.document.body.innerText="downloading..."),typeof s=="string")return w(s,f,A);var P=s.type==="application/octet-stream",H=/constructor/i.test(v.HTMLElement)||v.safari,_=/CriOS\/[\d]+/.test(navigator.userAgent);if((_||P&&H||y)&&typeof FileReader<"u"){var q=new FileReader;q.onloadend=function(){var k=q.result;k=_?k:k.replace(/^data:[^;]*;/,"data:attachment/file;"),d?d.location.href=k:location=k,d=null},q.readAsDataURL(s)}else{var $=v.URL||v.webkitURL,X=$.createObjectURL(s);d?d.location=X:location.href=X,d=null,setTimeout(function(){$.revokeObjectURL(X)},4e4)}});v.saveAs=S.saveAs=S,N.exports=S})}(J)),J.exports}var ue=ae();const me=te(ue);var Q={exports:{}},ee;function ce(){return ee||(ee=1,function(N){(function(V){var a=k(),w=ne(),D=re(),F=oe(),v={imagePlaceholder:void 0,cacheBust:!1},y={toSvg:S,toPng:f,toJpeg:A,toBlob:d,toPixelData:s,impl:{fontFaces:D,images:F,util:a,inliner:w,options:{}}};N.exports=y;function S(n,t){return t=t||{},P(t),Promise.resolve(n).then(function(i){return _(i,t.filter,!0)}).then(q).then($).then(r).then(function(i){return X(i,t.width||a.width(n),t.height||a.height(n))});function r(i){return t.bgcolor&&(i.style.backgroundColor=t.bgcolor),t.width&&(i.style.width=t.width+"px"),t.height&&(i.style.height=t.height+"px"),t.style&&Object.keys(t.style).forEach(function(h){i.style[h]=t.style[h]}),i}}function s(n,t){return H(n,t||{}).then(function(r){return r.getContext("2d").getImageData(0,0,a.width(n),a.height(n)).data})}function f(n,t){return H(n,t||{}).then(function(r){return r.toDataURL()})}function A(n,t){return t=t||{},H(n,t).then(function(r){return r.toDataURL("image/jpeg",t.quality||1)})}function d(n,t){return H(n,t||{}).then(a.canvasToBlob)}function P(n){typeof n.imagePlaceholder>"u"?y.impl.options.imagePlaceholder=v.imagePlaceholder:y.impl.options.imagePlaceholder=n.imagePlaceholder,typeof n.cacheBust>"u"?y.impl.options.cacheBust=v.cacheBust:y.impl.options.cacheBust=n.cacheBust}function H(n,t){return S(n,t).then(a.makeImage).then(a.delay(100)).then(function(i){var h=r(n);return h.getContext("2d").drawImage(i,0,0),h});function r(i){var h=document.createElement("canvas");if(h.width=t.width||a.width(i),h.height=t.height||a.height(i),t.bgcolor){var l=h.getContext("2d");l.fillStyle=t.bgcolor,l.fillRect(0,0,h.width,h.height)}return h}}function _(n,t,r){if(!r&&t&&!t(n))return Promise.resolve();return Promise.resolve(n).then(i).then(function(o){return h(n,o,t)}).then(function(o){return l(n,o)});function i(o){return o instanceof HTMLCanvasElement?a.makeImage(o.toDataURL()):o.cloneNode(!1)}function h(o,u,x){var L=o.childNodes;if(L.length===0)return Promise.resolve(u);return g(u,a.asArray(L),x).then(function(){return u});function g(M,T,E){var R=Promise.resolve();return T.forEach(function(O){R=R.then(function(){return _(O,E)}).then(function(U){U&&M.appendChild(U)})}),R}}function l(o,u){if(!(u instanceof Element))return u;return Promise.resolve().then(x).then(L).then(g).then(M).then(function(){return u});function x(){T(window.getComputedStyle(o),u.style);function T(E,R){E.cssText?R.cssText=E.cssText:O(E,R);function O(U,C){a.asArray(U).forEach(function(e){C.setProperty(e,U.getPropertyValue(e),U.getPropertyPriority(e))})}}}function L(){[":before",":after"].forEach(function(E){T(E)});function T(E){var R=window.getComputedStyle(o,E),O=R.getPropertyValue("content");if(O===""||O==="none")return;var U=a.uid();u.className=u.className+" "+U;var C=document.createElement("style");C.appendChild(e(U,E,R)),u.appendChild(C);function e(c,p,m){var b="."+c+":"+p,B=m.cssText?z(m):K(m);return document.createTextNode(b+"{"+B+"}");function z(I){var j=I.getPropertyValue("content");return I.cssText+" content: "+j+";"}function K(I){return a.asArray(I).map(j).join("; ")+";";function j(G){return G+": "+I.getPropertyValue(G)+(I.getPropertyPriority(G)?" !important":"")}}}}}function g(){o instanceof HTMLTextAreaElement&&(u.innerHTML=o.value),o instanceof HTMLInputElement&&u.setAttribute("value",o.value)}function M(){u instanceof SVGElement&&(u.setAttribute("xmlns","http://www.w3.org/2000/svg"),u instanceof SVGRectElement&&["width","height"].forEach(function(T){var E=u.getAttribute(T);E&&u.style.setProperty(T,E)}))}}}function q(n){return D.resolveAll().then(function(t){var r=document.createElement("style");return n.appendChild(r),r.appendChild(document.createTextNode(t)),n})}function $(n){return F.inlineAll(n).then(function(){return n})}function X(n,t,r){return Promise.resolve(n).then(function(i){return i.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(i)}).then(a.escapeXhtml).then(function(i){return'<foreignObject x="0" y="0" width="100%" height="100%">'+i+"</foreignObject>"}).then(function(i){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+t+'" height="'+r+'">'+i+"</svg>"}).then(function(i){return"data:image/svg+xml;charset=utf-8,"+i})}function k(){return{escape:M,parseExtension:t,mimeType:r,dataAsUrl:g,isDataUrl:i,canvasToBlob:l,resolveUrl:o,getAndEncode:L,uid:u(),delay:T,asArray:E,escapeXhtml:R,makeImage:x,width:O,height:U};function n(){var e="application/font-woff",c="image/jpeg";return{woff:e,woff2:e,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:c,jpeg:c,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}function t(e){var c=/\.([^\.\/]*?)$/g.exec(e);return c?c[1]:""}function r(e){var c=t(e).toLowerCase();return n()[c]||""}function i(e){return e.search(/^(data:)/)!==-1}function h(e){return new Promise(function(c){for(var p=window.atob(e.toDataURL().split(",")[1]),m=p.length,b=new Uint8Array(m),B=0;B<m;B++)b[B]=p.charCodeAt(B);c(new Blob([b],{type:"image/png"}))})}function l(e){return e.toBlob?new Promise(function(c){e.toBlob(c)}):h(e)}function o(e,c){var p=document.implementation.createHTMLDocument(),m=p.createElement("base");p.head.appendChild(m);var b=p.createElement("a");return p.body.appendChild(b),m.href=c,b.href=e,b.href}function u(){var e=0;return function(){return"u"+c()+e++;function c(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}}}function x(e){return new Promise(function(c,p){var m=new Image;m.onload=function(){c(m)},m.onerror=p,m.src=e})}function L(e){var c=3e4;return y.impl.options.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime()),new Promise(function(p){var m=new XMLHttpRequest;m.onreadystatechange=z,m.ontimeout=K,m.responseType="blob",m.timeout=c,m.open("GET",e,!0),m.send();var b;if(y.impl.options.imagePlaceholder){var B=y.impl.options.imagePlaceholder.split(/,/);B&&B[1]&&(b=B[1])}function z(){if(m.readyState===4){if(m.status!==200){b?p(b):I("cannot fetch resource: "+e+", status: "+m.status);return}var j=new FileReader;j.onloadend=function(){var G=j.result.split(/,/)[1];p(G)},j.readAsDataURL(m.response)}}function K(){b?p(b):I("timeout of "+c+"ms occured while fetching resource: "+e)}function I(j){console.error(j),p("")}})}function g(e,c){return"data:"+c+";base64,"+e}function M(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}function T(e){return function(c){return new Promise(function(p){setTimeout(function(){p(c)},e)})}}function E(e){for(var c=[],p=e.length,m=0;m<p;m++)c.push(e[m]);return c}function R(e){return e.replace(/#/g,"%23").replace(/\n/g,"%0A")}function O(e){var c=C(e,"border-left-width"),p=C(e,"border-right-width");return e.scrollWidth+c+p}function U(e){var c=C(e,"border-top-width"),p=C(e,"border-bottom-width");return e.scrollHeight+c+p}function C(e,c){var p=window.getComputedStyle(e).getPropertyValue(c);return parseFloat(p.replace("px",""))}}function ne(){var n=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:h,shouldProcess:t,impl:{readUrls:r,inline:i}};function t(l){return l.search(n)!==-1}function r(l){for(var o=[],u;(u=n.exec(l))!==null;)o.push(u[1]);return o.filter(function(x){return!a.isDataUrl(x)})}function i(l,o,u,x){return Promise.resolve(o).then(function(g){return u?a.resolveUrl(g,u):g}).then(x||a.getAndEncode).then(function(g){return a.dataAsUrl(g,a.mimeType(o))}).then(function(g){return l.replace(L(o),"$1"+g+"$3")});function L(g){return new RegExp(`(url\\(['"]?)(`+a.escape(g)+`)(['"]?\\))`,"g")}}function h(l,o,u){if(x())return Promise.resolve(l);return Promise.resolve(l).then(r).then(function(L){var g=Promise.resolve(l);return L.forEach(function(M){g=g.then(function(T){return i(T,M,o,u)})}),g});function x(){return!t(l)}}}function re(){return{resolveAll:n,impl:{readAll:t}};function n(){return t().then(function(r){return Promise.all(r.map(function(i){return i.resolve()}))}).then(function(r){return r.join(`
`)})}function t(){return Promise.resolve(a.asArray(document.styleSheets)).then(i).then(r).then(function(l){return l.map(h)});function r(l){return l.filter(function(o){return o.type===CSSRule.FONT_FACE_RULE}).filter(function(o){return w.shouldProcess(o.style.getPropertyValue("src"))})}function i(l){var o=[];return l.forEach(function(u){try{a.asArray(u.cssRules||[]).forEach(o.push.bind(o))}catch(x){console.log("Error while reading CSS rules from "+u.href,x.toString())}}),o}function h(l){return{resolve:function(){var u=(l.parentStyleSheet||{}).href;return w.inlineAll(l.cssText,u)},src:function(){return l.style.getPropertyValue("src")}}}}}function oe(){return{inlineAll:t,impl:{newImage:n}};function n(r){return{inline:i};function i(h){return a.isDataUrl(r.src)?Promise.resolve():Promise.resolve(r.src).then(h||a.getAndEncode).then(function(l){return a.dataAsUrl(l,a.mimeType(r.src))}).then(function(l){return new Promise(function(o,u){r.onload=o,r.onerror=u,r.src=l})})}}function t(r){if(!(r instanceof Element))return Promise.resolve(r);return i(r).then(function(){return r instanceof HTMLImageElement?n(r).inline():Promise.all(a.asArray(r.childNodes).map(function(h){return t(h)}))});function i(h){var l=h.style.getPropertyValue("background");return l?w.inlineAll(l).then(function(o){h.style.setProperty("background",o,h.style.getPropertyPriority("background"))}).then(function(){return h}):Promise.resolve(h)}}}})()}(Q)),Q.exports}var le=ce();const se=te(le),de=(N,V,a=[])=>{const w=Y(!1),D=Y();return{blob:D,converting:w,convertNodeToImage:async()=>{try{w.value=!0;const v=document.querySelector(N),y=v?await se.toBlob(v,{filter(S){return!(a!=null&&a.includes(S==null?void 0:S.id))}}):null;w.value=!1,y&&(D.value=y,V==null||V(y))}catch(v){w.value=!1,console.error("FAILED TO CONVERT NODE",v)}}}};export{me as s,de as u};
